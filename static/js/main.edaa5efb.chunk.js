(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{119:function(e,t,c){},120:function(e,t,c){},122:function(e,t,c){},127:function(e,t,c){},128:function(e,t,c){},130:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c.n(n),r=c(61),s=c.n(r),i=(c(70),c(65)),j=c(4),o=c(2),u=c(62),l=c.n(u),d=c(21),b=c.n(d),m=c(30),O=c(31),f=c.n(O),p=function(){var e=Object(m.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"GET",url:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(m.a)(b.a.mark((function e(t,c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"PATCH",url:t,data:c,headers:{"content-type":"application/json"}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}(),x=c(0),v=Object(n.createContext)(),g=function(e){var t=e.children,c=Object(n.useState)([]),a=Object(j.a)(c,2),r=a[0],s=a[1],i=Object(n.useState)(null),o=Object(j.a)(i,2),u=o[0],d=o[1];Object(n.useEffect)((function(){p("/api/product").then((function(e){e.data&&e.status&&s(e.data.data)})).catch((function(e){console.log("err",e)}));var e=l()("wss://backend-nodejs-mongodb.herokuapp.com",{transports:["websocket"]});return d(e),function(){return e.close()}}),[]);var b={products:[r,s],socket:u};return Object(x.jsx)(v.Provider,{value:b,children:t})},N=(c(119),0);var _=function(e){var t=e.product;N=e.numReviews?100-t.rating/t.numReviews*20:100-20*t.rating;var c={clipPath:0===t.rating?"inset(0 100% 0 0)":"inset(0 ".concat(N,"% 0 0)")};return Object(x.jsx)("div",{className:"rating",children:Object(x.jsxs)("div",{className:"star",children:[Object(x.jsx)("i",{className:"far fa-star"}),Object(x.jsx)("i",{className:"far fa-star"}),Object(x.jsx)("i",{className:"far fa-star"}),Object(x.jsx)("i",{className:"far fa-star"}),Object(x.jsx)("i",{className:"far fa-star"}),Object(x.jsxs)("div",{className:"star-1",style:c,children:[Object(x.jsx)("i",{className:"fas fa-star"}),Object(x.jsx)("i",{className:"fas fa-star"}),Object(x.jsx)("i",{className:"fas fa-star"}),Object(x.jsx)("i",{className:"fas fa-star"}),Object(x.jsx)("i",{className:"fas fa-star"})]})]})})};c(120);var y=function(e){var t=Object(n.useRef)(),c=Object(n.useRef)(),a=e.id,r=e.socket,s=e.rating;return Object(x.jsxs)("div",{className:"form_input",children:[Object(x.jsx)("p",{children:"Name:"}),Object(x.jsx)("input",{type:"text",ref:t}),Object(x.jsx)("p",{children:"Content:"}),Object(x.jsx)("div",{ref:c,contentEditable:"true",style:{height:"100px",border:"1px solid gray",padding:"5px 10px",outline:"none"}}),Object(x.jsx)("button",{onClick:function(){return function(){var e=t.current.value,n=c.current.innerHTML;if(!e.trim())return alert("Not Empty!");if(c.current.textContent.trim().length<10)return alert("Contents too short, must be at least 10 character!");(new Date).toISOString(),r.emit("createComment",{username:e,content:n,product_id:a,rating:s}),s&&0!==s&&h("/api/product/".concat(a),{rating:s}).then((function(e){})).catch((function(e){console.log("err",e)})),c.current.innerHTML=""}()},children:"Send"})]})},C=(c(59),c(63)),S=c.n(C);var k=function(e){var t=e.children,c=e.comment;return Object(x.jsxs)("div",{className:"comment_card",children:[Object(x.jsxs)("div",{className:"comment_card_row",children:[Object(x.jsx)("h3",{children:c.name}),0!==c.rating&&Object(x.jsx)(_,{product:c})]}),Object(x.jsx)("span",{children:S()(c.createdAt).fromNow()}),Object(x.jsx)("span",{children:new Date(c.createdAt).toLocaleString()}),Object(x.jsx)("p",{dangerouslySetInnerHTML:{__html:c.content}}),t]})},w=[];var R=function(e){var t=e.item,c=e.socket,a=Object(n.useState)(!1),r=Object(j.a)(a,2),s=r[0],i=r[1],o=Object(n.useState)(""),u=Object(j.a)(o,2),l=u[0],d=u[1],b=Object(n.useState)([]),m=Object(j.a)(b,2),O=m[0],f=m[1],p=Object(n.useState)([]),h=Object(j.a)(p,2),v=h[0],g=h[1],N=Object(n.useState)(3),_=Object(j.a)(N,2),C=_[0],S=_[1];Object(n.useEffect)((function(){!function(){var e=t.reply.length-C<0?0:t.reply.length-C;w=t.reply.slice(e,t.reply.length),g(e),f(w)}()}),[t.reply,C]);var R=function(e){i(!0),d(e)};return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(k,{comment:t,children:[Object(x.jsxs)("div",{className:"nav_comment",children:[Object(x.jsx)("p",{onClick:function(){return R(t.username)},children:"Reply"}),v>0&&Object(x.jsxs)("p",{onClick:function(){S(C+3)},children:["Load more ",v," comments"]}),Object(x.jsx)("p",{onClick:function(){i(!1),S(3)},children:"Hide Reply"})]}),Object(x.jsx)("div",{className:"reply_comment",children:O.map((function(e){return Object(x.jsx)(k,{comment:e,children:Object(x.jsx)("div",{className:"nav_comment",children:Object(x.jsx)("p",{onClick:function(){return R(e.username)},children:"Reply"})})},e._id)}))}),s&&Object(x.jsx)(y,{id:t._id,socket:c,name:l,setReply:i,send:"replyComment"})]})})},E=(c(122),c.p+"static/media/loading.b2f9bfa6.gif");var F=function(e){var t=Object(o.e)().id,c=Object(n.useState)(null),a=Object(j.a)(c,2),r=a[0],s=a[1],u=Object(n.useState)(0),l=Object(j.a)(u,2),d=l[0],b=l[1],m=Object(n.useState)([]),O=Object(j.a)(m,2),f=O[0],h=O[1],g=Object(n.useState)(!1),N=Object(j.a)(g,2),C=N[0],S=N[1],k=Object(n.useContext)(v),w=Object(j.a)(k.products,1)[0],F=k.socket,T=Object(n.useState)(1),L=Object(j.a)(T,2),M=L[0];return L[1],Object(n.useRef)(),Object(n.useEffect)((function(){if(t){var e=w.find((function(e){return e._id===t}));s(e)}}),[t,w]),Object(n.useState)((function(){S(!0),t&&p("/api/comment/".concat(t,"?limit=").concat(3*M)).then((function(e){S(!1),h(e.data.data)})).catch((function(e){console.log("err",e)}))}),[t,M]),Object(n.useEffect)((function(){return F&&F.emit("joinRoom",t),function(){}}),[F]),Object(n.useEffect)((function(){if(F)return F.on("sendCommentToClient",(function(e){h([e].concat(Object(i.a)(f)))})),function(){return F.off("sendCommentToClient")}}),[F,f]),Object(x.jsxs)("div",{className:"detail_product_page",children:[r&&Object(x.jsxs)("div",{className:"detail_product_card",children:[Object(x.jsx)("img",{src:r.images.url,alt:r.title}),Object(x.jsxs)("div",{className:"detail_product_cart_content",children:[Object(x.jsx)("h2",{children:r.title}),Object(x.jsxs)("span",{children:["$ ",r.price]}),Object(x.jsx)("p",{children:r.description}),Object(x.jsx)("button",{children:"Buy"}),Object(x.jsxs)("div",{children:[Object(x.jsxs)("h3",{children:["Rating: ",r.numReviews," reviews"]}),Object(x.jsx)(_,{product:r})]})]})]}),Object(x.jsxs)("div",{className:"comments",children:[Object(x.jsxs)("h2",{className:"app_title",children:["Realtime Website (chat, comments ...) with MERN Stack and Socket.io"," "]}),Object(x.jsxs)("div",{className:"reviews",children:[Object(x.jsx)("input",{type:"radio",name:"rate",id:"rd-5",onChange:function(){return b(5)}}),Object(x.jsx)("label",{htmlFor:"rd-5",className:"fas fa-star"}),Object(x.jsx)("input",{type:"radio",name:"rate",id:"rd-4",onChange:function(){return b(4)}}),Object(x.jsx)("label",{htmlFor:"rd-4",className:"fas fa-star"}),Object(x.jsx)("input",{type:"radio",name:"rate",id:"rd-3",onChange:function(){return b(3)}}),Object(x.jsx)("label",{htmlFor:"rd-3",className:"fas fa-star"}),Object(x.jsx)("input",{type:"radio",name:"rate",id:"rd-2",onChange:function(){return b(2)}}),Object(x.jsx)("label",{htmlFor:"rd-2",className:"fas fa-star"}),Object(x.jsx)("input",{type:"radio",name:"rate",id:"rd-1",onChange:function(){return b(1)}}),Object(x.jsx)("label",{htmlFor:"rd-1",className:"fas fa-star"})]}),Object(x.jsx)(y,{id:t,socket:F,rating:d}),Object(x.jsx)("div",{className:"comments_list",children:f&&f.map((function(e){return Object(x.jsx)(R,{item:e,socket:F},e._id)}))})]}),C&&Object(x.jsx)("div",{children:Object(x.jsx)("img",{src:E,alt:"loading"})})]})},T=c(19);c(127);var L=function(e){var t=e.item;return Object(x.jsxs)("div",{className:"product_card",children:[Object(x.jsx)("img",{src:t.images.url,alt:t.title}),Object(x.jsx)("h3",{children:t.title}),Object(x.jsxs)("span",{children:["$ ",t.price]}),Object(x.jsx)("p",{children:t.description}),Object(x.jsxs)("div",{className:"product_card_row",children:[Object(x.jsx)(T.b,{to:"/product/".concat(t._id),children:"View"}),Object(x.jsx)("button",{children:"Buy Now"})]})]})};c(128);var M=function(){var e=Object(n.useContext)(v),t=Object(j.a)(e.products,1)[0];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h2",{className:"app_title",children:"Realtime Website (chat, comments ...) with MERN Stack and Socket.io "}),Object(x.jsx)("div",{className:"products_page",children:t&&t.map((function(e){return Object(x.jsx)(L,{item:e},e._id)}))})]})};var H=function(e){return Object(x.jsx)(T.a,{children:Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)(o.a,{path:"/",exact:!0,component:M}),Object(x.jsx)(o.a,{path:"/product/:id",exact:!0,component:F})]})})},P=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,131)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;c(e),n(e),a(e),r(e),s(e)}))};c(129);s.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(g,{children:Object(x.jsx)(H,{})})}),document.getElementById("root")),P()},59:function(e,t,c){},70:function(e,t,c){}},[[130,1,2]]]);
//# sourceMappingURL=main.edaa5efb.chunk.js.map